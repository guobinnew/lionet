"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _utils=_interopRequireDefault(require("./utils")),_logger=_interopRequireDefault(require("./logger")),_verison=_interopRequireDefault(require("./verison")),_registry=_interopRequireDefault(require("./registry")),_atomicSimulator=_interopRequireDefault(require("./atomic-simulator")),_coordinator=_interopRequireDefault(require("./coordinator"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var spawnModel=function e(r){if(!r)return _logger.default.error("DevsSpawn::spawnModel failed - model is null"),null;if(!r.type)return _logger.default.error("DevsSpawn::spawnModel failed - model.type is null"),null;var l=null,n={name:r.name};if("atomic"===r.type)l=_registry.default.create(r.class,n);else if("coupled"===r.type){l=_registry.default.create("DevsCoupled",n);var o={children:[],links:r.links};if(r.children){var t=!0,a=!1,i=void 0;try{for(var u,s=r.children[Symbol.iterator]();!(t=(u=s.next()).done);t=!0){var d=u.value,p=e(d);if(!p)return _logger.default.error("DevsSpawn::spawnModel failed - model is invalid, ".concat(d)),null;o.children.push(p)}}catch(e){a=!0,i=e}finally{try{t||null==s.return||s.return()}finally{if(a)throw i}}}l.prepare(o)}return l},spawnSimulator=function(e){if(!e.model)return _logger.default.error("DevsSpawn::spawnAtomic failed - model is null"),null;var r=spawnModel(e.model),l=new _atomicSimulator.default(r);return l.snapshot(e),l},spawnCoordinator=function(e){if(!e.model)return _logger.default.error("DevsSpawn::spawnCoupled failed - option.model is null"),null;var r=spawnModel(e.model),l=new _coordinator.default(r);return l.snapshot(e),l},DevsSpawn={spawn:function(e){return e?_verison.default.isOlder(e.version)?(_logger.default.error("DevsSpawn::spawn failed - data version is older, current is ".concat(_verison.default.current)),null):"simulator"===e.type?spawnSimulator(e):"coordinator"===e.type?spawnCoordinator(e):null:(_logger.default.error("DevsSpawn::spawn failed - option is null"),null)},spawnModel:spawnModel},_default=DevsSpawn;exports.default=_default;