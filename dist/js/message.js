"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _entity=_interopRequireDefault(require("./entity")),_event=_interopRequireDefault(require("./event")),_utils=_interopRequireDefault(require("./utils")),_logger=_interopRequireDefault(require("./logger"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_superPropBase(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var DevsMessage=function(t){function a(t){return _classCallCheck(this,a),_possibleConstructorReturn(this,_getPrototypeOf(a).call(this,t))}return _inherits(a,_entity.default),_createClass(a,[{key:"addContent",value:function(t){_utils.default.common.isNull(t)?_logger.default.error("DevsMessage::addContent failed - content is null"):this.__contents__.push(t)}},{key:"setContent",value:function(t,e){_utils.default.common.isString(t)?_utils.default.common.hashString(t)?e?this.__contents__.push({port:t,event:e}):_logger.default.error("DevsMessage::setContent failed - event is null : ".concat(e)):_logger.default.error("DevsMessage::setContent failed - port is invalid : ".concat(t)):_logger.default.error("DevsMessage::setContent failed - port is not a string : ".concat(t))}},{key:"contentCount",value:function(){return this.__contents__.length}},{key:"getContent",value:function(t){return this.__contents__[t]}},{key:"getContents",value:function(t){if(!_utils.default.common.isString(t))return _logger.default.error("DevsMessage::getContents failed - port is not a string : ".concat(t)),null;var e=new Array,n=!0,r=!1,o=void 0;try{for(var i,s=this.__contents__[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;l.port===t&&e.push(l.event)}}catch(t){r=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}return e}},{key:"hasContents",value:function(t){if(!_utils.default.common.isString(t))return _logger.default.error("DevsMessage::hasContents failed - port is not a string : ".concat(t)),!1;var e=!1,n=!0,r=!1,o=void 0;try{for(var i,s=this.__contents__[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){if(i.value.port===t){e=!0;break}}}catch(t){r=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}return e}},{key:"deleteContent",value:function(t){0<=t&&t<this.__contents__.length?this.__contents__.splice(t,1):_logger.default.warn("DevsMessage::deleteContent failed - i is invalid : ".concat(t))}},{key:"deleteContents",value:function(t){if(_utils.default.common.isString(t)){var e=new Array,n=!0,r=!1,o=void 0;try{for(var i,s=this.__contents__[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;l.port!==t&&e.push(l)}}catch(t){r=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}this.__contents__=e}else _logger.default.error("DevsMessage::deleteContents failed - port is not a string : ".concat(t))}},{key:"empty",value:function(){return 0===this.__contents__.length}},{key:"setTimestamp",value:function(t){if(_utils.default.common.isNumber(t)){var e=!0,n=!1,r=void 0;try{for(var o,i=this.__contents__[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){o.value.event.timestamp(t)}}catch(t){n=!0,r=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}}else _logger.default.error("DevsMessage::setTimestamp failed - ts is not a number : ".concat(t))}},{key:"merge",value:function(t){if(t)if(t instanceof a){var e=!0,n=!1,r=void 0;try{for(var o,i=t.contents()[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var s=o.value;this.__contents__.push(s)}}catch(t){n=!0,r=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}}else _logger.default.error("DevsMessage::merge failed - msg is not a DevsMessage : ".concat(t))}},{key:"clear",value:function(){this.__contents__.splice(0,this.__contents__.length)}},{key:"contents",value:function(){return this.__contents__}},{key:"toJson",value:function(){var t=new Array,e=!0,n=!1,r=void 0;try{for(var o,i=this.__contents__[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var s=o.value;t.push({port:s.port,event:s.event.toJson()})}}catch(t){n=!0,r=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}return Object.assign(_get(_getPrototypeOf(a.prototype),"toJson",this).call(this),{contents:t})}},{key:"fromJson",value:function(t){if(_get(_getPrototypeOf(a.prototype),"fromJson",this).call(this,t),this.__contents__?this.__contents__.splice(0,this.__contents__.length):this.__contents__=new Array,_utils.default.common.isArray(t.contents)){var e=!0,n=!1,r=void 0;try{for(var o,i=t.contents[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var s=o.value,l=new _event.default(s.event);this.setContent(s.port,l)}}catch(t){n=!0,r=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}}}}]),a}(),_default=DevsMessage;exports.default=_default;